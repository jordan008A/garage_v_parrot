{% extends 'base.html.twig' %}

{% block title %}Accueil{% endblock %}

{% block body %}
<div class="container">
  {% for message in app.flashes('success') %}
      <div class="alert alert-success">{{ message }}</div>
  {% endfor %}

  {% for message in app.flashes('error') %}
      <div class="alert alert-danger">{{ message }}</div>
  {% endfor %}
</div>

<article class ="article-container">
    <div class="text-center mb-3">
      <h1 class="text-general h1">Bienvenue au garage V.Parrot</h1>
    </div>
    <div class="d-flex flex-column justify-content-evenly flex-lg-row align-items-lg-center">
      <img src="{{ asset('assets/img/historique.jpg') }}" alt="Historique" class="article-img d-block order-lg-first">
      <p class="article-text order-lg-last">
        Fondé en 2021 par Vincent Parrot, notre garage automobile à Toulouse est le fruit 
        de 15 années d'expérience solide et passionnée dans le domaine de la réparation automobile. 
        Fortement investi dans le monde de l'automobile depuis ses débuts, 
        Vincent Parrot a décidé de concrétiser son rêve en établissant son propre garage, 
        dédié à offrir des services de réparation et d'entretien exceptionnels. 
      </p>
    </div>
</article>

<article class ="article-container">
    <div class="text-center mb-3">
      <h1 class="text-general h1">Nos services</h1>
    </div>
    <div class="d-flex flex-column justify-content-evenly flex-lg-row align-items-lg-center">
      <img src="{{ asset('assets/img/services.jpg') }}" alt="Services" class="article-img d-block order-lg-last">
      <p class="article-text">
        Nous vous offrons une gamme complète de 
        <a href="{{ path('services.index') }}" class="mx-1 link">services</a>
        pour répondre à tous vos besoins de véhicule. De la vente de 
        <a href="{{ path('occasions.index') }}" class="mx-1 link">voitures d'occasion</a>
        , soigneusement sélectionnées et vérifiées, à une expertise mécanique complète comprenant 
        réparations générales, entretien périodique, services de climatisation et changement de pneus. 
        En cas de dommages extérieurs, notre équipe expérimentée effectue des réparations de 
        carrosserie de qualité. Notre garage vise à offrir une solution complète pour vos besoins 
        automobiles, mettant l'accent sur la qualité, la sécurité et la satisfaction du client.
      </p>
    </div>
</article>


<div class="container">
  <h1 class="text-center h1 mb-4">Votre avis compte pour nous !</h1>
  <form method="POST" class="public-review-form reviews-form row g-3 fs-4 form-p">
    <div class="col-md-6">
      <label for="lastname" class="form-label">Nom</label>
      <input type="text" name="lastname" class="form-control" maxlength="50" placeholder="Nom" required>
    </div>
    <div class="col-md-6">
      <label for="firstname" class="form-label">Prénom</label>
      <input type="text" name="firstname" class="form-control" maxlength="50" placeholder="Prénom" required>
    </div>
    <div class="col-12">
      <label for="subject" class="form-label">Sujet</label>
      <select name="subject" class="form-select"  required>
        <option selected disabled>Sélectionner un sujet...</option>
        {% for service in services %}
        <option value="{{ service.id }}">{{ service.title }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-12">
      <label for="comment" class="form-label">Commentaire</label>
      <textarea type="text" name="comment" class="form-control" id="area175" rows="4" placeholder="Max 175 caractères" maxlength="175" required></textarea>
      <p id="lengthValue175">0 / 175 caractères</p>
    </div>
    <div class="col-md-6 d-flex align-items-center justify-content-center">
      <div class="rating">
        <span class="star" data-rating="1">&#9733;</span>
        <span class="star" data-rating="2">&#9733;</span>
        <span class="star" data-rating="3">&#9733;</span>
        <span class="star" data-rating="4">&#9733;</span>
        <span class="star" data-rating="5">&#9733;</span>
      </div>
      <input type="hidden" name="ratingValue" id="ratingValue">
    </div>
    <div class="col-md-6 d-flex justify-content-center">
      <input type="hidden" name="_csrf_token" value="{{ csrf_token('public-review-form') }}">
      <button type="submit" class="btn button-p">Envoyer l'avis</button>
    </div>
  </form>
</div>

{% set hasReviews = false %}
<div class="container mt-5">
  <div id="reviewCarousel" class="carousel slide" data-bs-ride="true">
    <div class="carousel-inner">
      {% for review in reviews %}
      {% set hasReviews = true %}
      <div class="carousel-item {{ loop.first ? 'active' : '' }}">
        <div class="carousel-content custom-review-carousel">
          <div class="person-info">
            <p>{{ review.firstname }}.{{ review.lastname|first|upper }}</p>
            <div class="stars">
              {% for i in 1..review.rate %}
                <span class="rate">&#9733;</span>
              {% endfor %}
            </div>
          </div>
          <div class="subject">
            {{review.service.title}}
          </div>
          <div class="text">
            <p>
            "{{review.text}}"
            </p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#reviewCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon button-s" aria-hidden="true"></span>
      <span class="visually-hidden">Précédent</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#reviewCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon button-s" aria-hidden="true"></span>
      <span class="visually-hidden">Suivant</span>
    </button>
  </div>
</div>
{% if not hasReviews %}
  <h5 class="text-center">Aucun avis pour l'instant.</h5>
{% endif %}
<script src="{{ asset('assets/javascript/saveStarsValue.js') }}"></script>
<script src="{{ asset('assets/javascript/limitCharacters175.js') }}"></script>
{% endblock %}
